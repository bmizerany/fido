#!/bin/sh
set -e

base_dir=$(dirname $0)
tear_dir=${TEARDIR:="~/.tear"}

function die() {
	echo "$1" >&2
	exit 1
}

function cmdify() {
	echo "$(basename $cmd | sed 's|tear-||')"
}

function tildify() {
	echo $(echo $1 | sed "s|$HOME|~|")
}

function see_usage() {
	[ -n "$1" ] && echo "!! $1" >&2 && echo >&2
	echo "$(usage $0)" >&2
	exit 1
}

function usage() {
	prog='
		BEGIN { inusage=0 }
		/^# USAGE/ { inusage=1; next }
		/^[^#]/    { {if(inusage=1) exit;} }
		/^# (.*)/  { {if(inusage=1) print substr($0, 3)} }
		/^#\s*$/   { {if(inusage=1) print ""} }
	'
	raw=$(awk "$prog" $1)
	echo "Usage: $1 $raw"
	[ -n "$USAGE2" ] && echo && echo "$USAGE2"
}

function desc() {
	usage $1 | head -n2 | tail -n1
}

# vim: syn=sh
