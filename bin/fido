#!/usr/bin/env ruby
$LOAD_PATH.unshift File.dirname(__FILE__) + "/../lib"
require 'optparse'
require 'fido'
require 'logger'

debug = false
force = false

ARGV.options do |o|
  o.banner = "Usage: fido <git-url> [branch[, work, bug123]]"
  o.separator "\n"
  o.separator "  This example will clone <git-url> and checkout"
  o.separator "  to work if origin/work exists otherwise origin/bug123"
  o.separator "  or origin/master (implied)"
  o.separator "\n"
  o.on_tail("-f", "--force", "destructive fetch") { force = true }
  o.on_tail("-h", "--help", "Show this message") { abort(o.to_s) }
  o.on_tail("-d", "--debug", "Show debug information") { debug = true }
  o.parse!

  abort(o.to_s) if ARGV.empty?
end

ARGV << force if force

if debug
  Fido.new(Logger.new(STDOUT))
else
  Fido.new
end.clone(*ARGV)

#vim: syn=ruby
